---
---

<div
	id="reading-progress"
	class="fixed top-0 left-0 h-[2px] bg-gray-900 dark:bg-gray-100 z-50 transition-opacity duration-300"
	style="width: 0%; opacity: 0;"
	aria-hidden="true"
></div>

<script>
	function initReadingProgress() {
		const bar = document.getElementById("reading-progress");
		const article = document.querySelector("article");
		if (!bar || !article) return;

		const update = () => {
			const rect = article.getBoundingClientRect();
			const articleTop = rect.top + window.scrollY;
			const articleHeight = rect.height;
			const scrolled = window.scrollY - articleTop;
			const progress = Math.min(Math.max(scrolled / (articleHeight - window.innerHeight), 0), 1);

			bar.style.width = `${progress * 100}%`;
			bar.style.opacity = progress > 0 && progress < 1 ? "1" : "0";
		};

		window.addEventListener("scroll", update, { passive: true });
		update();
	}

	initReadingProgress();
	document.addEventListener("astro:after-swap", initReadingProgress);
</script>
